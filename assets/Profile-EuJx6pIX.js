import{m as f,p as j,q as x,t,b as a,w as l,D as m,c as G,d as J,W as K,E as h,e as c,a as b,y as k,u as n,Y as O,ao as Q,ap as X,x as ee,aq as te,ar as ae,as as v,Z as le,a9 as se,at as oe,a8 as ne,a0 as ie,F as de}from"./vendor-MJUihXSy.js";import{_ as re}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ue={class:"profile-container"},ce={class:"profile-header"},me={class:"merchant-info"},pe={class:"merchant-detail"},fe={class:"merchant-name"},ve={class:"merchant-id"},_e={class:"income-overview"},ge={class:"overview-item"},he={class:"item-value"},be={class:"overview-item"},ke={class:"item-value"},we={class:"overview-item"},ye={class:"item-value"},Ce={class:"feature-section"},Ve={class:"feature-grid"},xe={class:"feature-section"},Be={class:"feature-list"},Ie={class:"item-left"},Fe={class:"item-left"},Se={class:"item-left"},Me={class:"feature-section"},Pe={class:"feature-list"},Ue={class:"item-left"},qe={class:"item-left"},Ee=["src"],Ne={key:1,class:"avatar-placeholder"},Te={class:"dialog-footer"},Ae={__name:"Profile",setup(De){const r=de(),i=f({id:"M88888888",name:"大荤窗口",avatar:"",balance:1234.56,todayIncome:356.8,monthIncome:12345.67,phone:"13800138000",description:"主营各类炒菜、炖菜，提供美味可口的大荤菜品。"}),B=f(2),p=f(!1),w=f(!1),y=f(null),s=j({avatar:"",name:"",phone:"",description:""}),F={name:[{required:!0,message:"请输入商家名称",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],phone:[{required:!0,message:"请输入联系电话",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号码",trigger:"blur"}]},S=()=>{p.value=!0,s.avatar=i.value.avatar,s.name=i.value.name,s.phone=i.value.phone,s.description=i.value.description},M=()=>{r.push("/m/admin/profile/withdraw")},P=()=>{r.push("/m/admin/profile/bank-accounts")},U=()=>{r.push("/m/admin/profile/security")},q=()=>{r.push("/m/admin/profile/notifications")},E=()=>{r.push("/m/admin/profile/window")},N=()=>{r.push("/m/admin/profile/business-time")},T=()=>{r.push("/m/admin/profile/printer")},A=()=>{r.push("/m/admin/profile/help")},D=()=>{r.push("/m/admin/profile/about")},R=async()=>{try{await K.confirm("确定要退出登录吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),localStorage.removeItem("token"),localStorage.removeItem("user"),r.push("/login"),h.success("已退出登录")}catch{}},W=u=>{s.avatar=u.url},z=u=>{const e=u.type.startsWith("image/"),C=u.size/1024/1024<2;return e?C?!0:(h.error("上传头像图片大小不能超过 2MB!"),!1):(h.error("上传头像图片只能是图片格式!"),!1)},L=async()=>{if(y.value)try{await y.value.validate(),w.value=!0,await new Promise(u=>setTimeout(u,1e3)),i.value={...i.value,avatar:s.avatar,name:s.name,phone:s.phone,description:s.description},h.success("个人信息更新成功"),p.value=!1}catch(u){console.error("更新个人信息失败：",u)}finally{w.value=!1}};return(u,e)=>{const C=c("el-avatar"),o=c("el-icon"),_=c("el-button"),$=c("el-badge"),H=c("el-upload"),g=c("el-form-item"),V=c("el-input"),Y=c("el-form"),Z=c("el-dialog");return b(),x("div",ue,[t("div",ce,[t("div",me,[a(C,{size:64,src:i.value.avatar,class:"merchant-avatar"},{default:l(()=>{var d,I;return[k(m((I=(d=i.value.name)==null?void 0:d[0])==null?void 0:I.toUpperCase()),1)]}),_:1},8,["src"]),t("div",pe,[t("div",fe,m(i.value.name),1),t("div",ve,"商家ID: "+m(i.value.id),1)]),a(_,{class:"edit-profile-btn",type:"primary",link:"",onClick:S},{default:l(()=>[a(o,null,{default:l(()=>[a(n(O))]),_:1})]),_:1})]),t("div",_e,[t("div",ge,[t("div",he,"¥"+m(i.value.balance.toFixed(2)),1),e[5]||(e[5]=t("div",{class:"item-label"},"账户余额",-1))]),t("div",be,[t("div",ke,"¥"+m(i.value.todayIncome.toFixed(2)),1),e[6]||(e[6]=t("div",{class:"item-label"},"今日收入",-1))]),t("div",we,[t("div",ye,"¥"+m(i.value.monthIncome.toFixed(2)),1),e[7]||(e[7]=t("div",{class:"item-label"},"本月收入",-1))])])]),t("div",Ce,[e[12]||(e[12]=t("div",{class:"section-title"},"账户管理",-1)),t("div",Ve,[t("div",{class:"feature-item",onClick:M},[a(o,null,{default:l(()=>[a(n(Q))]),_:1}),e[8]||(e[8]=t("span",null,"提现管理",-1))]),t("div",{class:"feature-item",onClick:P},[a(o,null,{default:l(()=>[a(n(X))]),_:1}),e[9]||(e[9]=t("span",null,"收款账户",-1))]),t("div",{class:"feature-item",onClick:U},[a(o,null,{default:l(()=>[a(n(ee))]),_:1}),e[10]||(e[10]=t("span",null,"安全设置",-1))]),t("div",{class:"feature-item",onClick:q},[a(o,null,{default:l(()=>[a(n(te))]),_:1}),e[11]||(e[11]=t("span",null,"消息通知",-1)),B.value>0?(b(),G($,{key:0,value:B.value,class:"notification-badge"},null,8,["value"])):J("",!0)])])]),t("div",xe,[e[16]||(e[16]=t("div",{class:"section-title"},"商家服务",-1)),t("div",Be,[t("div",{class:"list-item",onClick:E},[t("div",Ie,[a(o,null,{default:l(()=>[a(n(ae))]),_:1}),e[13]||(e[13]=t("span",null,"窗口管理",-1))]),a(o,{class:"arrow-icon"},{default:l(()=>[a(n(v))]),_:1})]),t("div",{class:"list-item",onClick:N},[t("div",Fe,[a(o,null,{default:l(()=>[a(n(le))]),_:1}),e[14]||(e[14]=t("span",null,"营业时间",-1))]),a(o,{class:"arrow-icon"},{default:l(()=>[a(n(v))]),_:1})]),t("div",{class:"list-item",onClick:T},[t("div",Se,[a(o,null,{default:l(()=>[a(n(se))]),_:1}),e[15]||(e[15]=t("span",null,"打印机设置",-1))]),a(o,{class:"arrow-icon"},{default:l(()=>[a(n(v))]),_:1})])])]),t("div",Me,[e[19]||(e[19]=t("div",{class:"section-title"},"其他服务",-1)),t("div",Pe,[t("div",{class:"list-item",onClick:A},[t("div",Ue,[a(o,null,{default:l(()=>[a(n(oe))]),_:1}),e[17]||(e[17]=t("span",null,"帮助中心",-1))]),a(o,{class:"arrow-icon"},{default:l(()=>[a(n(v))]),_:1})]),t("div",{class:"list-item",onClick:D},[t("div",qe,[a(o,null,{default:l(()=>[a(n(ne))]),_:1}),e[18]||(e[18]=t("span",null,"关于我们",-1))]),a(o,{class:"arrow-icon"},{default:l(()=>[a(n(v))]),_:1})])])]),a(_,{class:"logout-button",type:"danger",plain:"",onClick:R},{default:l(()=>e[20]||(e[20]=[k("退出登录")])),_:1}),a(Z,{modelValue:p.value,"onUpdate:modelValue":e[4]||(e[4]=d=>p.value=d),title:"编辑个人信息",width:"90%","close-on-click-modal":!1},{footer:l(()=>[t("div",Te,[a(_,{onClick:e[3]||(e[3]=d=>p.value=!1)},{default:l(()=>e[22]||(e[22]=[k("取消")])),_:1}),a(_,{type:"primary",onClick:L,loading:w.value},{default:l(()=>e[23]||(e[23]=[k(" 保存 ")])),_:1},8,["loading"])])]),default:l(()=>[a(Y,{ref_key:"editFormRef",ref:y,model:s,rules:F,"label-position":"top"},{default:l(()=>[a(g,{label:"头像"},{default:l(()=>[a(H,{class:"avatar-uploader",action:"/api/upload","show-file-list":!1,"on-success":W,"before-upload":z},{default:l(()=>[s.avatar?(b(),x("img",{key:0,src:s.avatar,class:"avatar"},null,8,Ee)):(b(),x("div",Ne,[a(o,{class:"avatar-uploader-icon"},{default:l(()=>[a(n(ie))]),_:1}),e[21]||(e[21]=t("span",null,"点击上传头像",-1))]))]),_:1})]),_:1}),a(g,{label:"商家名称",prop:"name"},{default:l(()=>[a(V,{modelValue:s.name,"onUpdate:modelValue":e[0]||(e[0]=d=>s.name=d),placeholder:"请输入商家名称"},null,8,["modelValue"])]),_:1}),a(g,{label:"联系电话",prop:"phone"},{default:l(()=>[a(V,{modelValue:s.phone,"onUpdate:modelValue":e[1]||(e[1]=d=>s.phone=d),placeholder:"请输入联系电话"},null,8,["modelValue"])]),_:1}),a(g,{label:"商家简介",prop:"description"},{default:l(()=>[a(V,{modelValue:s.description,"onUpdate:modelValue":e[2]||(e[2]=d=>s.description=d),type:"textarea",rows:"4",placeholder:"请输入商家简介"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},ze=re(Ae,[["__scopeId","data-v-a06be6ac"]]);export{ze as default};
