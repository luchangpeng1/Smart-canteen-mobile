import{m as p,q as g,t as s,b as a,w as i,D as P,J as U,L as E,W as M,E as d,e as u,a as f,u as T,am as N,a0 as F,y,c as L,a1 as j,d as q,F as A}from"./vendor-DLSupzTO.js";import{_ as I}from"./_plugin-vue_export-helper-DlAUqK2U.js";const J={class:"business-time-container"},R={class:"page-header"},W={class:"time-settings"},z={class:"status-card"},G={class:"status-info"},K={class:"status-desc"},O={class:"time-periods-card"},Q={class:"card-header"},X={class:"periods-list"},Y={class:"period-time"},Z={class:"period-tips"},ee={class:"auto-business-card"},te={class:"card-header"},se={class:"action-bar"},ae={__name:"BusinessTime",setup(le){const k=A(),r=p(!0),h=p(!1),_=p(!1),n=p([{startTime:new Date(2e3,0,1,10,30),endTime:new Date(2e3,0,1,13,30)}]),C=()=>{k.push("/m/admin/profile")},B=async t=>{try{await M.confirm(`确定要${t?"开始营业":"打烊"}吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:t?"success":"warning"}),d.success(`已${t?"开始营业":"打烊"}`)}catch{r.value=!t}},S=t=>{t&&d.warning("请确保已设置正确的营业时间段")},x=()=>{if(n.value.length>=3){d.warning("最多只能添加3个时间段");return}n.value.push({startTime:new Date(2e3,0,1,10,0),endTime:new Date(2e3,0,1,22,0)})},$=t=>{n.value.splice(t,1)},v=()=>{const t=n.value;for(const e of t){if(!e.startTime||!e.endTime)return d.warning("请填写完整的营业时间"),!1;if(e.endTime<=e.startTime)return d.warning("结束时间必须晚于开始时间"),!1}for(let e=0;e<t.length;e++)for(let l=e+1;l<t.length;l++)if(t[e].startTime<=t[l].endTime&&t[e].endTime>=t[l].startTime||t[l].startTime<=t[e].endTime&&t[l].endTime>=t[e].startTime)return d.warning("营业时间段不能重叠"),!1;return!0},D=async()=>{if(v())try{_.value=!0;const t=n.value.map(e=>({startTime:`${e.startTime.getHours().toString().padStart(2,"0")}:${e.startTime.getMinutes().toString().padStart(2,"0")}`,endTime:`${e.endTime.getHours().toString().padStart(2,"0")}:${e.endTime.getMinutes().toString().padStart(2,"0")}`}));await new Promise(e=>setTimeout(e,1e3)),d.success("设置已保存")}catch{d.error("保存失败，请重试")}finally{_.value=!1}};return(t,e)=>{const l=u("el-icon"),c=u("el-button"),w=u("el-switch"),b=u("el-time-picker"),H=u("el-alert");return f(),g("div",J,[s("div",R,[a(c,{class:"back-button",link:"",onClick:C},{default:i(()=>[a(l,null,{default:i(()=>[a(T(N))]),_:1})]),_:1}),e[2]||(e[2]=s("span",{class:"page-title"},"营业时间",-1))]),s("div",W,[s("div",z,[s("div",G,[e[3]||(e[3]=s("div",{class:"status-title"},"营业状态",-1)),s("div",K,P(r.value?"营业中":"已打烊"),1)]),a(w,{modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=o=>r.value=o),"active-text":"营业","inactive-text":"打烊",onChange:B,class:"status-switch",style:{"--el-switch-on-color":"#07c160","--el-switch-off-color":"rgba(0,0,0,0.25)"}},null,8,["modelValue"])]),s("div",O,[s("div",Q,[e[5]||(e[5]=s("div",{class:"card-title"},"营业时间段",-1)),a(c,{type:"primary",link:"",disabled:n.value.length>=3,onClick:x},{default:i(()=>[a(l,null,{default:i(()=>[a(T(F))]),_:1}),e[4]||(e[4]=y(" 添加时间段 "))]),_:1},8,["disabled"])]),s("div",X,[(f(!0),g(U,null,E(n.value,(o,V)=>(f(),g("div",{key:V,class:"period-item"},[s("div",Y,[a(b,{modelValue:o.startTime,"onUpdate:modelValue":m=>o.startTime=m,format:"HH:mm",placeholder:"开始时间",disabled:!r.value,onChange:v},null,8,["modelValue","onUpdate:modelValue","disabled"]),e[6]||(e[6]=s("span",{class:"time-separator"},"至",-1)),a(b,{modelValue:o.endTime,"onUpdate:modelValue":m=>o.endTime=m,format:"HH:mm",placeholder:"结束时间",disabled:!r.value,onChange:v},null,8,["modelValue","onUpdate:modelValue","disabled"])]),n.value.length>1?(f(),L(c,{key:0,type:"danger",circle:"",disabled:!r.value,onClick:m=>$(V)},{default:i(()=>[a(l,null,{default:i(()=>[a(T(j))]),_:1})]),_:2},1032,["disabled","onClick"])):q("",!0)]))),128))]),s("div",Z,[a(H,{title:"提示",type:"info",closable:!1,"show-icon":""},{default:i(()=>e[7]||(e[7]=[s("p",null,"1. 最多可添加3个营业时间段",-1),s("p",null,"2. 时间段之间不能重叠",-1),s("p",null,"3. 修改后需点击保存才能生效",-1)])),_:1})])]),s("div",ee,[s("div",te,[e[8]||(e[8]=s("div",{class:"card-title"},"自动营业",-1)),a(w,{modelValue:h.value,"onUpdate:modelValue":e[1]||(e[1]=o=>h.value=o),onChange:S},null,8,["modelValue"])]),e[9]||(e[9]=s("div",{class:"card-desc"}," 开启后，系统将按照设置的营业时间自动开启/关闭营业状态 ",-1))])]),s("div",se,[a(c,{type:"primary",class:"save-button",loading:_.value,onClick:D},{default:i(()=>e[10]||(e[10]=[y(" 保存设置 ")])),_:1},8,["loading"])])])}}},ie=I(ae,[["__scopeId","data-v-c227e13a"]]);export{ie as default};
