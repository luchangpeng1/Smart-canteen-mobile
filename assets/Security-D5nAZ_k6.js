import{p as q,m as u,q as G,t as o,b as s,w as l,D as R,E as k,e as _,a as H,u as i,am as J,x as K,ak as b,ap as L,aq as O,ar as Q,y as P,F as W}from"./vendor-DLSupzTO.js";import{_ as X}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Y={class:"security-container"},Z={class:"page-header"},ee={class:"security-list"},se={class:"item-left"},le={class:"item-left"},oe={class:"item-left"},ae={class:"item-info"},te={class:"item-desc"},de={class:"item-left"},ie={class:"item-info"},re={class:"item-desc"},ne={class:"dialog-footer"},ue={class:"dialog-footer"},me={__name:"Security",setup(fe){const U=W(),h=q({phone:"13888888888",isVerified:!0}),m=u(!1),C=u(""),n=u(null),r=q({oldPassword:"",newPassword:"",confirmPassword:""}),S={oldPassword:[{required:!0,message:"请输入当前密码"},{min:6,message:"密码长度不能小于6位"}],newPassword:[{required:!0,message:"请输入新密码"},{min:6,message:"密码长度不能小于6位"}],confirmPassword:[{required:!0,message:"请确认新密码"},{validator:(t,e,d)=>{e!==r.newPassword?d(new Error("两次输入的密码不一致")):d()},trigger:"blur"}]},y=u(!1),f=u(null),c=q({phone:"",code:""}),D={phone:[{required:!0,message:"请输入手机号"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号"}],code:[{required:!0,message:"请输入验证码"},{pattern:/^\d{6}$/,message:"请输入6位数字验证码"}]},p=u(!1),v=u(0);let F=null;const I=()=>{U.push("/m/admin/profile")},B=()=>{C.value="修改登录密码",m.value=!0,n.value&&n.value.resetFields()},E=()=>{C.value="修改支付密码",m.value=!0,n.value&&n.value.resetFields()},M=()=>{y.value=!0,f.value&&f.value.resetFields()},T=()=>{if(h.isVerified){k.info("您已完成实名认证");return}U.push("/m/admin/profile/verify")},N=async()=>{if(n.value)try{await n.value.validate(),p.value=!0,await new Promise(t=>setTimeout(t,1e3)),k.success("密码修改成功"),m.value=!1}catch(t){console.error("密码修改失败：",t)}finally{p.value=!1}},j=async()=>{try{await f.value.validateField("phone"),v.value=60,F=setInterval(()=>{v.value--,v.value<=0&&(clearInterval(F),F=null)},1e3),k.success("验证码已发送")}catch(t){console.error("发送验证码失败：",t)}},z=async()=>{if(f.value)try{await f.value.validate(),p.value=!0,await new Promise(t=>setTimeout(t,1e3)),h.phone=c.phone,k.success("手机号修改成功"),y.value=!1}catch(t){console.error("手机号修改失败：",t)}finally{p.value=!1}},A=t=>t.replace(/(\d{3})\d{4}(\d{4})/,"$1****$2");return(t,e)=>{const d=_("el-icon"),w=_("el-button"),V=_("el-input"),g=_("el-form-item"),$=_("el-form"),x=_("el-dialog");return H(),G("div",Y,[o("div",Z,[s(w,{class:"back-button",link:"",onClick:I},{default:l(()=>[s(d,null,{default:l(()=>[s(i(J))]),_:1})]),_:1}),e[9]||(e[9]=o("span",{class:"page-title"},"安全设置",-1))]),o("div",ee,[o("div",{class:"security-item",onClick:B},[o("div",se,[s(d,{class:"item-icon"},{default:l(()=>[s(i(K))]),_:1}),e[10]||(e[10]=o("div",{class:"item-info"},[o("div",{class:"item-title"},"登录密码"),o("div",{class:"item-desc"},"建议定期更换密码，提高账号安全性")],-1))]),s(d,{class:"arrow-icon"},{default:l(()=>[s(i(b))]),_:1})]),o("div",{class:"security-item",onClick:E},[o("div",le,[s(d,{class:"item-icon"},{default:l(()=>[s(i(L))]),_:1}),e[11]||(e[11]=o("div",{class:"item-info"},[o("div",{class:"item-title"},"支付密码"),o("div",{class:"item-desc"},"用于提现等资金操作，请妥善保管")],-1))]),s(d,{class:"arrow-icon"},{default:l(()=>[s(i(b))]),_:1})]),o("div",{class:"security-item",onClick:M},[o("div",oe,[s(d,{class:"item-icon"},{default:l(()=>[s(i(O))]),_:1}),o("div",ae,[e[12]||(e[12]=o("div",{class:"item-title"},"手机号码",-1)),o("div",te,"已绑定："+R(A(h.phone)),1)])]),s(d,{class:"arrow-icon"},{default:l(()=>[s(i(b))]),_:1})]),o("div",{class:"security-item",onClick:T},[o("div",de,[s(d,{class:"item-icon"},{default:l(()=>[s(i(Q))]),_:1}),o("div",ie,[e[13]||(e[13]=o("div",{class:"item-title"},"实名认证",-1)),o("div",re,R(h.isVerified?"已认证":"未认证"),1)])]),s(d,{class:"arrow-icon"},{default:l(()=>[s(i(b))]),_:1})])]),s(x,{modelValue:m.value,"onUpdate:modelValue":e[4]||(e[4]=a=>m.value=a),title:C.value,width:"90%","close-on-click-modal":!1},{footer:l(()=>[o("div",ne,[s(w,{onClick:e[3]||(e[3]=a=>m.value=!1)},{default:l(()=>e[14]||(e[14]=[P("取消")])),_:1}),s(w,{type:"primary",onClick:N,loading:p.value},{default:l(()=>e[15]||(e[15]=[P(" 确认修改 ")])),_:1},8,["loading"])])]),default:l(()=>[s($,{ref_key:"passwordFormRef",ref:n,model:r,rules:S,"label-position":"top"},{default:l(()=>[s(g,{label:"当前密码",prop:"oldPassword"},{default:l(()=>[s(V,{modelValue:r.oldPassword,"onUpdate:modelValue":e[0]||(e[0]=a=>r.oldPassword=a),type:"password","show-password":"",placeholder:"请输入当前密码"},null,8,["modelValue"])]),_:1}),s(g,{label:"新密码",prop:"newPassword"},{default:l(()=>[s(V,{modelValue:r.newPassword,"onUpdate:modelValue":e[1]||(e[1]=a=>r.newPassword=a),type:"password","show-password":"",placeholder:"请输入新密码"},null,8,["modelValue"])]),_:1}),s(g,{label:"确认新密码",prop:"confirmPassword"},{default:l(()=>[s(V,{modelValue:r.confirmPassword,"onUpdate:modelValue":e[2]||(e[2]=a=>r.confirmPassword=a),type:"password","show-password":"",placeholder:"请再次输入新密码"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),s(x,{modelValue:y.value,"onUpdate:modelValue":e[8]||(e[8]=a=>y.value=a),title:"修改手机号",width:"90%","close-on-click-modal":!1},{footer:l(()=>[o("div",ue,[s(w,{onClick:e[7]||(e[7]=a=>y.value=!1)},{default:l(()=>e[16]||(e[16]=[P("取消")])),_:1}),s(w,{type:"primary",onClick:z,loading:p.value},{default:l(()=>e[17]||(e[17]=[P(" 确认修改 ")])),_:1},8,["loading"])])]),default:l(()=>[s($,{ref_key:"phoneFormRef",ref:f,model:c,rules:D,"label-position":"top"},{default:l(()=>[s(g,{label:"新手机号",prop:"phone"},{default:l(()=>[s(V,{modelValue:c.phone,"onUpdate:modelValue":e[5]||(e[5]=a=>c.phone=a),placeholder:"请输入新手机号"},{append:l(()=>[s(w,{type:"primary",disabled:!!v.value,onClick:j},{default:l(()=>[P(R(v.value?`${v.value}s`:"获取验证码"),1)]),_:1},8,["disabled"])]),_:1},8,["modelValue"])]),_:1}),s(g,{label:"验证码",prop:"code"},{default:l(()=>[s(V,{modelValue:c.code,"onUpdate:modelValue":e[6]||(e[6]=a=>c.code=a),placeholder:"请输入验证码"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},we=X(me,[["__scopeId","data-v-96f0ee94"]]);export{we as default};
