import{m,p as U,J as E,q as p,t as o,D as f,b as a,w as l,c as R,N,O as I,E as h,e as u,a as c,y as _,u as V,_ as ie,ab as re,ac as ue,ad as de,M as ce,d as M,A as me,F as pe,$ as fe}from"./vendor-qvz31vGP.js";import{_ as _e}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ve={class:"withdraw-container"},be={class:"balance-card"},ye={class:"balance-info"},ge={class:"balance-amount"},ke={class:"today-income"},we={class:"income-amount"},Ne={class:"withdraw-form"},he={class:"account-section"},Ve={class:"section-header"},Ae={class:"bind-account-actions"},Ce={key:0,class:"account-list"},qe={class:"account-info"},xe=["src","alt"],Be={class:"account-detail"},De={class:"bank-name"},Fe={class:"account-number"},Ie={class:"withdraw-tips"},Me={class:"withdraw-history"},Te={class:"history-header"},$e={key:1,class:"history-list"},Ue={class:"record-info"},Ee={class:"record-amount"},Re={class:"record-detail"},We={class:"record-account"},He={class:"record-time"},Se={key:2,class:"wechat-bind-tip"},Ye={class:"qrcode-container"},ze={class:"qrcode-placeholder"},Le={class:"dialog-footer"},W="https://example.com/wechat-qr.png",Oe={__name:"Withdraw",setup(Pe){const H=pe(),A=m(1234.56),S=m(356.8),q=m(2),C=[{id:1,bank:"工商银行",accountNumber:"**** **** **** 8888",icon:"/icons/icbc.png",label:"工商银行 (8888)"},{id:2,bank:"支付宝",accountNumber:"138****8888",icon:"/icons/alipay.png",label:"支付宝 (8888)"}],r=U({amount:"",bankAccount:""}),Y={amount:[{required:!0,message:"请输入提现金额"},{validator:(n,e,s)=>{if(typeof e!="number"){s(new Error("请输入有效的提现金额"));return}if(e<100){s(new Error("最低提现金额为100元"));return}if(e>5e4){s(new Error("单笔提现上限为50000元"));return}if(e>A.value){s(new Error("提现金额不能大于余额"));return}s()},trigger:"change"}],bankAccount:[{required:!0,message:"请选择提现账户",trigger:"change"}]},z=E(()=>q.value>0&&A.value>=100),b=m(null),x=m(!1),L=()=>{r.amount=Math.min(A.value,5e4),b.value&&b.value.validateField("amount")},B=m([{id:1,amount:1e3,status:"success",bankInfo:"工商银行 (8888)",createTime:"2024-03-20 14:30:00"},{id:2,amount:2e3,status:"pending",bankInfo:"支付宝 (8888)",createTime:"2024-03-19 16:20:00"}]),O=n=>({success:"提现成功",pending:"处理中",failed:"提现失败"})[n]||n,P=n=>fe(n).format("YYYY-MM-DD HH:mm"),j=()=>{H.push("/m/admin/withdraw/history")},J=async()=>{if(b.value)try{if(!r.amount||!r.bankAccount){h.warning("请填写完整的提现信息");return}await b.value.validate(),x.value=!0;const n=r.amount,e=C.find(s=>s.id===r.bankAccount);await new Promise(s=>setTimeout(s,1e3)),h.success("提现申请已提交"),B.value.unshift({id:Date.now(),amount:n,status:"pending",bankInfo:(e==null?void 0:e.label)||"",createTime:new Date().toISOString()}),q.value--,r.amount="",r.bankAccount=""}catch(n){n.message?h.error(n.message):h.error("提现申请失败，请重试"),console.error("提现失败：",n)}finally{x.value=!1}},y=m(!1),d=m(""),D=m(!1),g=m(null),Q=[{code:"ICBC",name:"工商银行"},{code:"ABC",name:"农业银行"},{code:"BOC",name:"中国银行"},{code:"CCB",name:"建设银行"},{code:"CMB",name:"招商银行"}],i=U({bankName:"",holderName:"",accountNumber:"",alipayAccount:"",realName:""}),G={bankName:[{required:!0,message:"请选择开户银行"}],holderName:[{required:!0,message:"请输入持卡人姓名"}],accountNumber:[{required:!0,message:"请输入银行卡号"},{pattern:/^\d{16,19}$/,message:"请输入正确的银行卡号"}],alipayAccount:[{required:!0,message:"请输入支付宝账号"},{type:"email",message:"请输入正确的邮箱格式"}],realName:[{required:!0,message:"请输入真实姓名"}]},K=E(()=>({bank:"绑定银行卡",alipay:"绑定支付宝",wechat:"绑定微信"})[d.value]||"绑定账户"),F=n=>{d.value=n,y.value=!0,g.value&&g.value.resetFields()},X=async()=>{if(g.value)try{await g.value.validate(),D.value=!0,await new Promise(e=>setTimeout(e,1e3));const n={id:Date.now(),bank:d.value==="bank"?i.bankName:d.value==="alipay"?"支付宝":"微信",accountNumber:d.value==="bank"?`**** **** **** ${i.accountNumber.slice(-4)}`:i.alipayAccount||"",icon:`/icons/${d.value}.png`,label:`${d.value==="bank"?i.bankName:d.value==="alipay"?"支付宝":"微信"} (${i.accountNumber.slice(-4)})`};C.push(n),h.success("绑定成功"),y.value=!1}catch(n){console.error("绑定失败：",n)}finally{D.value=!1}},Z=n=>{r.amount=parseFloat(n)||""};return(n,e)=>{const s=u("el-button"),k=u("el-input"),v=u("el-form-item"),w=u("el-icon"),ee=u("el-radio"),te=u("el-radio-group"),T=u("el-empty"),$=u("el-form"),ae=u("el-option"),oe=u("el-select"),le=u("el-alert"),ne=u("el-image"),se=u("el-dialog");return c(),p("div",ve,[o("div",be,[o("div",ye,[e[12]||(e[12]=o("div",{class:"balance-title"},"当前余额",-1)),o("div",ge,"¥ "+f(A.value.toFixed(2)),1)]),o("div",ke,[e[13]||(e[13]=o("div",{class:"income-title"},"今日收入",-1)),o("div",we,"¥ "+f(S.value.toFixed(2)),1)])]),o("div",Ne,[a($,{model:r,rules:Y,ref_key:"formRef",ref:b,"label-position":"top"},{default:l(()=>[a(v,{prop:"amount",label:"提现金额"},{default:l(()=>[a(k,{modelValue:r.amount,"onUpdate:modelValue":e[0]||(e[0]=t=>r.amount=t),modelModifiers:{number:!0},type:"number",onInput:Z,placeholder:"请输入提现金额"},{prefix:l(()=>e[14]||(e[14]=[_("¥")])),append:l(()=>[a(s,{type:"primary",link:"",onClick:L},{default:l(()=>e[15]||(e[15]=[_("全部提现")])),_:1})]),_:1},8,["modelValue"])]),_:1}),o("div",he,[o("div",Ve,[e[19]||(e[19]=o("span",{class:"section-title"},"提现账户",-1)),o("div",Ae,[a(s,{type:"primary",link:"",onClick:e[1]||(e[1]=t=>F("alipay"))},{default:l(()=>[a(w,null,{default:l(()=>[a(V(ie))]),_:1}),e[16]||(e[16]=_(" 绑定支付宝 "))]),_:1}),a(s,{type:"success",link:"",onClick:e[2]||(e[2]=t=>F("wechat"))},{default:l(()=>[a(w,null,{default:l(()=>[a(V(re))]),_:1}),e[17]||(e[17]=_(" 绑定微信 "))]),_:1}),a(s,{type:"warning",link:"",onClick:e[3]||(e[3]=t=>F("bank"))},{default:l(()=>[a(w,null,{default:l(()=>[a(V(ue))]),_:1}),e[18]||(e[18]=_(" 绑定银行卡 "))]),_:1})])]),C.length>0?(c(),p("div",Ce,[a(te,{modelValue:r.bankAccount,"onUpdate:modelValue":e[4]||(e[4]=t=>r.bankAccount=t),class:"account-radio-group"},{default:l(()=>[(c(),p(N,null,I(C,t=>a(ee,{key:t.id,value:t.id,class:"account-radio-item"},{default:l(()=>[o("div",qe,[o("img",{src:t.icon,alt:t.bank,class:"bank-icon"},null,8,xe),o("div",Be,[o("span",De,f(t.bank),1),o("span",Fe,f(t.accountNumber),1)])])]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"])])):(c(),R(T,{key:1,description:"暂无绑定账户","image-size":60,class:"no-account-tip"}))])]),_:1},8,["model"]),o("div",Ie,[e[23]||(e[23]=o("p",null,"提现说明：",-1)),o("ul",null,[e[20]||(e[20]=o("li",null,"最低提现金额：100元",-1)),e[21]||(e[21]=o("li",null,"提现到账时间：1-3个工作日",-1)),o("li",null,"每日提现次数上限：3次（今日剩余："+f(q.value)+"次）",1),e[22]||(e[22]=o("li",null,"单笔提现上限：50000元",-1))])]),a(s,{type:"primary",class:"withdraw-button",loading:x.value,disabled:!z.value,onClick:J},{default:l(()=>e[24]||(e[24]=[_(" 申请提现 ")])),_:1},8,["loading","disabled"])]),o("div",Me,[o("div",Te,[e[26]||(e[26]=o("h3",null,"提现记录",-1)),a(s,{type:"primary",link:"",onClick:j},{default:l(()=>[e[25]||(e[25]=_(" 查看全部 ")),a(w,null,{default:l(()=>[a(V(de))]),_:1})]),_:1})]),B.value.length===0?(c(),R(T,{key:0,description:"暂无提现记录"})):(c(),p("div",$e,[(c(!0),p(N,null,I(B.value,t=>(c(),p("div",{key:t.id,class:"history-item"},[o("div",Ue,[o("div",Ee,"¥ "+f(t.amount.toFixed(2)),1),o("div",{class:ce(["record-status",t.status])},f(O(t.status)),3)]),o("div",Re,[o("div",We,f(t.bankInfo),1),o("div",He,f(P(t.createTime)),1)])]))),128))]))]),a(se,{modelValue:y.value,"onUpdate:modelValue":e[11]||(e[11]=t=>y.value=t),title:K.value,width:"90%","show-close":!1,class:"bind-dialog"},{footer:l(()=>[o("div",Le,[a(s,{onClick:e[10]||(e[10]=t=>y.value=!1)},{default:l(()=>e[28]||(e[28]=[_("取消")])),_:1}),a(s,{type:"primary",onClick:X,loading:D.value,disabled:d.value==="wechat"},{default:l(()=>e[29]||(e[29]=[_(" 确认绑定 ")])),_:1},8,["loading","disabled"])])]),default:l(()=>[a($,{model:i,rules:G,ref_key:"bindFormRef",ref:g,"label-position":"top"},{default:l(()=>[d.value==="bank"?(c(),p(N,{key:0},[a(v,{label:"开户银行",prop:"bankName"},{default:l(()=>[a(oe,{modelValue:i.bankName,"onUpdate:modelValue":e[5]||(e[5]=t=>i.bankName=t),placeholder:"请选择开户银行"},{default:l(()=>[(c(),p(N,null,I(Q,t=>a(ae,{key:t.code,label:t.name,value:t.code},{default:l(()=>[_(f(t.name),1)]),_:2},1032,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),a(v,{label:"持卡人姓名",prop:"holderName"},{default:l(()=>[a(k,{modelValue:i.holderName,"onUpdate:modelValue":e[6]||(e[6]=t=>i.holderName=t),placeholder:"请输入持卡人姓名"},null,8,["modelValue"])]),_:1}),a(v,{label:"银行卡号",prop:"accountNumber"},{default:l(()=>[a(k,{modelValue:i.accountNumber,"onUpdate:modelValue":e[7]||(e[7]=t=>i.accountNumber=t),placeholder:"请输入银行卡号"},null,8,["modelValue"])]),_:1})],64)):M("",!0),d.value==="alipay"?(c(),p(N,{key:1},[a(v,{label:"支付宝账号",prop:"alipayAccount"},{default:l(()=>[a(k,{modelValue:i.alipayAccount,"onUpdate:modelValue":e[8]||(e[8]=t=>i.alipayAccount=t),placeholder:"请输入支付宝账号"},null,8,["modelValue"])]),_:1}),a(v,{label:"真实姓名",prop:"realName"},{default:l(()=>[a(k,{modelValue:i.realName,"onUpdate:modelValue":e[9]||(e[9]=t=>i.realName=t),placeholder:"请输入真实姓名"},null,8,["modelValue"])]),_:1})],64)):M("",!0),d.value==="wechat"?(c(),p("div",Se,[a(le,{title:"请使用微信扫描下方二维码进行账号绑定",type:"info",closable:!1,center:""}),o("div",Ye,[a(ne,{src:W,fit:"contain",class:"qrcode","preview-src-list":[W]},{error:l(()=>[o("div",ze,[a(w,{size:40},{default:l(()=>[a(V(me))]),_:1}),e[27]||(e[27]=o("span",null,"二维码加载失败",-1))])]),_:1},8,["preview-src-list"])])])):M("",!0)]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},Qe=_e(Oe,[["__scopeId","data-v-a270f9fa"]]);export{Qe as default};
