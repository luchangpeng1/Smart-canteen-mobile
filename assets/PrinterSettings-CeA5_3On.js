import{m as y,p as Y,q as b,t as r,b as e,w as l,J as B,L as E,c as j,e as n,a as p,u as i,ak as G,a0 as H,a9 as K,D as T,O as Q,y as _,Y as X,a1 as Z,am as ee,F as te,W as U,E as w}from"./vendor-CrV3p34f.js";import{_ as le}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ae={class:"printer-settings-container"},se={class:"page-header"},oe={class:"printer-content"},ne={key:0,class:"printer-list"},de={class:"printer-info"},re={class:"printer-icon"},ie={class:"printer-detail"},ue={class:"printer-name"},ce={class:"printer-desc"},me={class:"printer-actions"},pe={class:"dialog-footer"},_e={__name:"PrinterSettings",setup(fe){const S=te(),u=y([{id:1,name:"前台打印机",type:"usb",address:"COM3",copies:1,isEnabled:!0},{id:2,name:"厨房打印机",type:"network",address:"192.168.1.100",copies:2,isEnabled:!0}]),P=[{label:"USB打印机",value:"usb"},{label:"网络打印机",value:"network"},{label:"蓝牙打印机",value:"bluetooth"}],c=y(!1),f=y(!1),V=y(!1),v=y(null),a=Y({name:"",type:"",address:"",copies:1}),q={name:[{required:!0,message:"请输入打印机名称",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],type:[{required:!0,message:"请选择打印机类型",trigger:"change"}],address:[{required:!0,message:"请输入打印机地址",trigger:"blur"}]},D=()=>{S.push("/m/admin/profile")},h=()=>{f.value=!1,a.name="",a.type="",a.address="",a.copies=1,c.value=!0,v.value&&v.value.resetFields()},F=async(o,t)=>{try{await U.confirm(`确定要${o?"启用":"禁用"}该打印机吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:o?"success":"warning"}),w.success(`已${o?"启用":"禁用"}打印机`)}catch{t.isEnabled=!o}},M=async(o,t)=>{switch(o){case"test":try{await new Promise(d=>setTimeout(d,1e3)),w.success("测试页打印成功")}catch{w.error("打印失败，请检查打印机状态")}break;case"edit":f.value=!0,a.name=t.name,a.type=t.type,a.address=t.address,a.copies=t.copies,c.value=!0;break;case"delete":try{await U.confirm("确定要删除该打印机吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),u.value=u.value.filter(d=>d.id!==t.id),w.success("删除成功")}catch{}break}},N=async()=>{if(v.value)try{if(await v.value.validate(),V.value=!0,await new Promise(o=>setTimeout(o,1e3)),f.value){const o=u.value.find(t=>t.name===a.name);o&&(o.type=a.type,o.address=a.address,o.copies=a.copies)}else u.value.push({id:Date.now(),name:a.name,type:a.type,address:a.address,copies:a.copies,isEnabled:!0});w.success(f.value?"更新成功":"添加成功"),c.value=!1}catch(o){console.error("保存失败：",o)}finally{V.value=!1}};return(o,t)=>{const d=n("el-icon"),m=n("el-button"),R=n("el-switch"),C=n("el-dropdown-item"),$=n("el-dropdown-menu"),I=n("el-dropdown"),L=n("el-empty"),x=n("el-input"),k=n("el-form-item"),O=n("el-option"),z=n("el-select"),A=n("el-input-number"),J=n("el-form"),W=n("el-dialog");return p(),b("div",ae,[r("div",se,[e(m,{class:"back-button",link:"",onClick:D},{default:l(()=>[e(d,null,{default:l(()=>[e(i(G))]),_:1})]),_:1}),t[6]||(t[6]=r("span",{class:"page-title"},"打印机设置",-1)),e(m,{class:"add-button",link:"",onClick:h},{default:l(()=>[e(d,null,{default:l(()=>[e(i(H))]),_:1})]),_:1})]),r("div",oe,[u.value.length>0?(p(),b("div",ne,[(p(!0),b(B,null,E(u.value,s=>(p(),b("div",{key:s.id,class:"printer-item"},[r("div",de,[r("div",re,[e(d,null,{default:l(()=>[e(i(K))]),_:1})]),r("div",ie,[r("div",ue,T(s.name),1),r("div",ce,T(s.address),1)])]),r("div",me,[e(R,{modelValue:s.isEnabled,"onUpdate:modelValue":g=>s.isEnabled=g,onChange:g=>F(g,s),class:"status-switch"},null,8,["modelValue","onUpdate:modelValue","onChange"]),e(I,{trigger:"click",onCommand:g=>M(g,s)},{dropdown:l(()=>[e($,null,{default:l(()=>[e(C,{command:"test"},{default:l(()=>[e(d,null,{default:l(()=>[e(i(Q))]),_:1}),t[7]||(t[7]=_(" 打印测试页 "))]),_:1}),e(C,{command:"edit"},{default:l(()=>[e(d,null,{default:l(()=>[e(i(X))]),_:1}),t[8]||(t[8]=_(" 编辑打印机 "))]),_:1}),e(C,{command:"delete",class:"danger"},{default:l(()=>[e(d,null,{default:l(()=>[e(i(Z))]),_:1}),t[9]||(t[9]=_(" 删除打印机 "))]),_:1})]),_:1})]),default:l(()=>[e(m,{type:"primary",link:""},{default:l(()=>[e(d,null,{default:l(()=>[e(i(ee))]),_:1})]),_:1})]),_:2},1032,["onCommand"])])]))),128))])):(p(),j(L,{key:1,description:"暂无打印机","image-size":120},{default:l(()=>[e(m,{type:"primary",onClick:h},{default:l(()=>t[10]||(t[10]=[_("添加打印机")])),_:1})]),_:1}))]),e(W,{modelValue:c.value,"onUpdate:modelValue":t[5]||(t[5]=s=>c.value=s),title:f.value?"编辑打印机":"添加打印机",width:"90%","close-on-click-modal":!1},{footer:l(()=>[r("div",pe,[e(m,{onClick:t[4]||(t[4]=s=>c.value=!1)},{default:l(()=>t[11]||(t[11]=[_("取消")])),_:1}),e(m,{type:"primary",onClick:N,loading:V.value},{default:l(()=>t[12]||(t[12]=[_(" 保存 ")])),_:1},8,["loading"])])]),default:l(()=>[e(J,{ref_key:"formRef",ref:v,model:a,rules:q,"label-position":"top"},{default:l(()=>[e(k,{label:"打印机名称",prop:"name"},{default:l(()=>[e(x,{modelValue:a.name,"onUpdate:modelValue":t[0]||(t[0]=s=>a.name=s),placeholder:"请输入打印机名称"},null,8,["modelValue"])]),_:1}),e(k,{label:"打印机类型",prop:"type"},{default:l(()=>[e(z,{modelValue:a.type,"onUpdate:modelValue":t[1]||(t[1]=s=>a.type=s),placeholder:"请选择打印机类型"},{default:l(()=>[(p(),b(B,null,E(P,s=>e(O,{key:s.value,label:s.label,value:s.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),e(k,{label:"打印机地址",prop:"address"},{default:l(()=>[e(x,{modelValue:a.address,"onUpdate:modelValue":t[2]||(t[2]=s=>a.address=s),placeholder:"请输入打印机IP地址或串口地址"},null,8,["modelValue"])]),_:1}),e(k,{label:"打印份数",prop:"copies"},{default:l(()=>[e(A,{modelValue:a.copies,"onUpdate:modelValue":t[3]||(t[3]=s=>a.copies=s),min:1,max:5,step:1,"step-strictly":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},ye=le(_e,[["__scopeId","data-v-853801ae"]]);export{ye as default};
