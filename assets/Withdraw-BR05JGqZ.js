import{m,p as E,S as R,q as p,t as a,b as t,w as l,D as f,c as S,J as N,L as I,E as V,e as r,a as c,u as y,au as ue,y as _,ao as re,av as de,ap as ce,as as me,M as pe,d as M,A as fe,F as _e,U as ve}from"./vendor-MJUihXSy.js";import{_ as be}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ye={class:"withdraw-container"},ge={class:"page-header"},ke={class:"balance-card"},we={class:"balance-info"},he={class:"balance-amount"},Ne={class:"today-income"},Ve={class:"income-amount"},Ce={class:"withdraw-form"},Ae={class:"account-section"},Be={class:"section-header"},qe={class:"bind-account-actions"},xe={key:0,class:"account-list"},De={class:"account-info"},Fe=["src","alt"],Ie={class:"account-detail"},Me={class:"bank-name"},Te={class:"account-number"},Ue={class:"withdraw-tips"},$e={class:"withdraw-history"},Ee={class:"history-header"},Re={key:1,class:"history-list"},Se={class:"record-info"},We={class:"record-amount"},He={class:"record-detail"},Le={class:"record-account"},Ye={class:"record-time"},ze={key:2,class:"wechat-bind-tip"},Oe={class:"qrcode-container"},Pe={class:"qrcode-placeholder"},je={class:"dialog-footer"},W="https://example.com/wechat-qr.png",Je={__name:"Withdraw",setup(Qe){const T=_e(),C=m(1234.56),H=m(356.8),B=m(2),A=[{id:1,bank:"工商银行",accountNumber:"**** **** **** 8888",icon:"/icons/icbc.png",label:"工商银行 (8888)"},{id:2,bank:"支付宝",accountNumber:"138****8888",icon:"/icons/alipay.png",label:"支付宝 (8888)"}],u=E({amount:"",bankAccount:""}),L={amount:[{required:!0,message:"请输入提现金额"},{validator:(n,e,i)=>{if(typeof e!="number"){i(new Error("请输入有效的提现金额"));return}if(e<100){i(new Error("最低提现金额为100元"));return}if(e>5e4){i(new Error("单笔提现上限为50000元"));return}if(e>C.value){i(new Error("提现金额不能大于余额"));return}i()},trigger:"change"}],bankAccount:[{required:!0,message:"请选择提现账户",trigger:"change"}]},Y=R(()=>B.value>0&&C.value>=100),g=m(null),q=m(!1),z=()=>{u.amount=Math.min(C.value,5e4),g.value&&g.value.validateField("amount")},x=m([{id:1,amount:1e3,status:"success",bankInfo:"工商银行 (8888)",createTime:"2024-03-20 14:30:00"},{id:2,amount:2e3,status:"pending",bankInfo:"支付宝 (8888)",createTime:"2024-03-19 16:20:00"}]),O=n=>({success:"提现成功",pending:"处理中",failed:"提现失败"})[n]||n,P=n=>ve(n).format("YYYY-MM-DD HH:mm"),j=()=>{T.push("/m/admin/withdraw/history")},J=async()=>{if(g.value)try{if(!u.amount||!u.bankAccount){V.warning("请填写完整的提现信息");return}await g.value.validate(),q.value=!0;const n=u.amount,e=A.find(i=>i.id===u.bankAccount);await new Promise(i=>setTimeout(i,1e3)),V.success("提现申请已提交"),x.value.unshift({id:Date.now(),amount:n,status:"pending",bankInfo:(e==null?void 0:e.label)||"",createTime:new Date().toISOString()}),B.value--,u.amount="",u.bankAccount=""}catch(n){n.message?V.error(n.message):V.error("提现申请失败，请重试"),console.error("提现失败：",n)}finally{q.value=!1}},k=m(!1),d=m(""),D=m(!1),w=m(null),Q=[{code:"ICBC",name:"工商银行"},{code:"ABC",name:"农业银行"},{code:"BOC",name:"中国银行"},{code:"CCB",name:"建设银行"},{code:"CMB",name:"招商银行"}],s=E({bankName:"",holderName:"",accountNumber:"",alipayAccount:"",realName:""}),G={bankName:[{required:!0,message:"请选择开户银行"}],holderName:[{required:!0,message:"请输入持卡人姓名"}],accountNumber:[{required:!0,message:"请输入银行卡号"},{pattern:/^\d{16,19}$/,message:"请输入正确的银行卡号"}],alipayAccount:[{required:!0,message:"请输入支付宝账号"},{type:"email",message:"请输入正确的邮箱格式"}],realName:[{required:!0,message:"请输入真实姓名"}]},K=R(()=>({bank:"绑定银行卡",alipay:"绑定支付宝",wechat:"绑定微信"})[d.value]||"绑定账户"),F=n=>{d.value=n,k.value=!0,w.value&&w.value.resetFields()},X=async()=>{if(w.value)try{await w.value.validate(),D.value=!0,await new Promise(e=>setTimeout(e,1e3));const n={id:Date.now(),bank:d.value==="bank"?s.bankName:d.value==="alipay"?"支付宝":"微信",accountNumber:d.value==="bank"?`**** **** **** ${s.accountNumber.slice(-4)}`:s.alipayAccount||"",icon:`/icons/${d.value}.png`,label:`${d.value==="bank"?s.bankName:d.value==="alipay"?"支付宝":"微信"} (${s.accountNumber.slice(-4)})`};A.push(n),V.success("绑定成功"),k.value=!1}catch(n){console.error("绑定失败：",n)}finally{D.value=!1}},Z=n=>{u.amount=parseFloat(n)||""},ee=()=>{T.push("/m/admin/profile")};return(n,e)=>{const i=r("el-icon"),v=r("el-button"),h=r("el-input"),b=r("el-form-item"),te=r("el-radio"),ae=r("el-radio-group"),U=r("el-empty"),$=r("el-form"),oe=r("el-option"),le=r("el-select"),ne=r("el-alert"),se=r("el-image"),ie=r("el-dialog");return c(),p("div",ye,[a("div",ge,[t(v,{class:"back-button",link:"",onClick:ee},{default:l(()=>[t(i,null,{default:l(()=>[t(y(ue))]),_:1})]),_:1}),e[12]||(e[12]=a("span",{class:"page-title"},"提现管理",-1))]),a("div",ke,[a("div",we,[e[13]||(e[13]=a("div",{class:"balance-title"},"当前余额",-1)),a("div",he,"¥ "+f(C.value.toFixed(2)),1)]),a("div",Ne,[e[14]||(e[14]=a("div",{class:"income-title"},"今日收入",-1)),a("div",Ve,"¥ "+f(H.value.toFixed(2)),1)])]),a("div",Ce,[t($,{model:u,rules:L,ref_key:"formRef",ref:g,"label-position":"top"},{default:l(()=>[t(b,{prop:"amount",label:"提现金额"},{default:l(()=>[t(h,{modelValue:u.amount,"onUpdate:modelValue":e[0]||(e[0]=o=>u.amount=o),modelModifiers:{number:!0},type:"number",onInput:Z,placeholder:"请输入提现金额"},{prefix:l(()=>e[15]||(e[15]=[_("¥")])),append:l(()=>[t(v,{type:"primary",link:"",onClick:z},{default:l(()=>e[16]||(e[16]=[_("全部提现")])),_:1})]),_:1},8,["modelValue"])]),_:1}),a("div",Ae,[a("div",Be,[e[20]||(e[20]=a("span",{class:"section-title"},"提现账户",-1)),a("div",qe,[t(v,{type:"primary",link:"",onClick:e[1]||(e[1]=o=>F("alipay"))},{default:l(()=>[t(i,null,{default:l(()=>[t(y(re))]),_:1}),e[17]||(e[17]=_(" 绑定支付宝 "))]),_:1}),t(v,{type:"success",link:"",onClick:e[2]||(e[2]=o=>F("wechat"))},{default:l(()=>[t(i,null,{default:l(()=>[t(y(de))]),_:1}),e[18]||(e[18]=_(" 绑定微信 "))]),_:1}),t(v,{type:"warning",link:"",onClick:e[3]||(e[3]=o=>F("bank"))},{default:l(()=>[t(i,null,{default:l(()=>[t(y(ce))]),_:1}),e[19]||(e[19]=_(" 绑定银行卡 "))]),_:1})])]),A.length>0?(c(),p("div",xe,[t(ae,{modelValue:u.bankAccount,"onUpdate:modelValue":e[4]||(e[4]=o=>u.bankAccount=o),class:"account-radio-group"},{default:l(()=>[(c(),p(N,null,I(A,o=>t(te,{key:o.id,value:o.id,class:"account-radio-item"},{default:l(()=>[a("div",De,[a("img",{src:o.icon,alt:o.bank,class:"bank-icon"},null,8,Fe),a("div",Ie,[a("span",Me,f(o.bank),1),a("span",Te,f(o.accountNumber),1)])])]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"])])):(c(),S(U,{key:1,description:"暂无绑定账户","image-size":60,class:"no-account-tip"}))])]),_:1},8,["model"]),a("div",Ue,[e[24]||(e[24]=a("p",null,"提现说明：",-1)),a("ul",null,[e[21]||(e[21]=a("li",null,"最低提现金额：100元",-1)),e[22]||(e[22]=a("li",null,"提现到账时间：1-3个工作日",-1)),a("li",null,"每日提现次数上限：3次（今日剩余："+f(B.value)+"次）",1),e[23]||(e[23]=a("li",null,"单笔提现上限：50000元",-1))])]),t(v,{type:"primary",class:"withdraw-button",loading:q.value,disabled:!Y.value,onClick:J},{default:l(()=>e[25]||(e[25]=[_(" 申请提现 ")])),_:1},8,["loading","disabled"])]),a("div",$e,[a("div",Ee,[e[27]||(e[27]=a("h3",null,"提现记录",-1)),t(v,{type:"primary",link:"",onClick:j},{default:l(()=>[e[26]||(e[26]=_(" 查看全部 ")),t(i,null,{default:l(()=>[t(y(me))]),_:1})]),_:1})]),x.value.length===0?(c(),S(U,{key:0,description:"暂无提现记录"})):(c(),p("div",Re,[(c(!0),p(N,null,I(x.value,o=>(c(),p("div",{key:o.id,class:"history-item"},[a("div",Se,[a("div",We,"¥ "+f(o.amount.toFixed(2)),1),a("div",{class:pe(["record-status",o.status])},f(O(o.status)),3)]),a("div",He,[a("div",Le,f(o.bankInfo),1),a("div",Ye,f(P(o.createTime)),1)])]))),128))]))]),t(ie,{modelValue:k.value,"onUpdate:modelValue":e[11]||(e[11]=o=>k.value=o),title:K.value,width:"90%","show-close":!1,class:"bind-dialog"},{footer:l(()=>[a("div",je,[t(v,{onClick:e[10]||(e[10]=o=>k.value=!1)},{default:l(()=>e[29]||(e[29]=[_("取消")])),_:1}),t(v,{type:"primary",onClick:X,loading:D.value,disabled:d.value==="wechat"},{default:l(()=>e[30]||(e[30]=[_(" 确认绑定 ")])),_:1},8,["loading","disabled"])])]),default:l(()=>[t($,{model:s,rules:G,ref_key:"bindFormRef",ref:w,"label-position":"top"},{default:l(()=>[d.value==="bank"?(c(),p(N,{key:0},[t(b,{label:"开户银行",prop:"bankName"},{default:l(()=>[t(le,{modelValue:s.bankName,"onUpdate:modelValue":e[5]||(e[5]=o=>s.bankName=o),placeholder:"请选择开户银行"},{default:l(()=>[(c(),p(N,null,I(Q,o=>t(oe,{key:o.code,label:o.name,value:o.code},{default:l(()=>[_(f(o.name),1)]),_:2},1032,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),t(b,{label:"持卡人姓名",prop:"holderName"},{default:l(()=>[t(h,{modelValue:s.holderName,"onUpdate:modelValue":e[6]||(e[6]=o=>s.holderName=o),placeholder:"请输入持卡人姓名"},null,8,["modelValue"])]),_:1}),t(b,{label:"银行卡号",prop:"accountNumber"},{default:l(()=>[t(h,{modelValue:s.accountNumber,"onUpdate:modelValue":e[7]||(e[7]=o=>s.accountNumber=o),placeholder:"请输入银行卡号"},null,8,["modelValue"])]),_:1})],64)):M("",!0),d.value==="alipay"?(c(),p(N,{key:1},[t(b,{label:"支付宝账号",prop:"alipayAccount"},{default:l(()=>[t(h,{modelValue:s.alipayAccount,"onUpdate:modelValue":e[8]||(e[8]=o=>s.alipayAccount=o),placeholder:"请输入支付宝账号"},null,8,["modelValue"])]),_:1}),t(b,{label:"真实姓名",prop:"realName"},{default:l(()=>[t(h,{modelValue:s.realName,"onUpdate:modelValue":e[9]||(e[9]=o=>s.realName=o),placeholder:"请输入真实姓名"},null,8,["modelValue"])]),_:1})],64)):M("",!0),d.value==="wechat"?(c(),p("div",ze,[t(ne,{title:"请使用微信扫描下方二维码进行账号绑定",type:"info",closable:!1,center:""}),a("div",Oe,[t(se,{src:W,fit:"contain",class:"qrcode","preview-src-list":[W]},{error:l(()=>[a("div",Pe,[t(i,{size:40},{default:l(()=>[t(y(fe))]),_:1}),e[28]||(e[28]=a("span",null,"二维码加载失败",-1))])]),_:1},8,["preview-src-list"])])])):M("",!0)]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},Xe=be(Je,[["__scopeId","data-v-bde255ec"]]);export{Xe as default};
