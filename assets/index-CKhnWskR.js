const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Login-C_aQ_ZRh.js","assets/vendor-CrV3p34f.js","assets/vendor-C6q9dLkW.css","assets/_plugin-vue_export-helper-DlAUqK2U.js","assets/Login-DGCT1fUd.css","assets/Layout-C_DY7tAy.js","assets/Layout-eckf87hl.css","assets/Orders-ym5KTIzT.js","assets/Orders-BlntUbZd.css","assets/Menu-B6dnXY5g.js","assets/Menu-BNHHLoP6.css","assets/Stats-B5kjNwAh.js","assets/Stats-BfyS-_KS.css","assets/Profile-DPK01GhW.js","assets/Profile-CbwqdqTL.css","assets/Withdraw-qFR6BGCY.js","assets/Withdraw-v0_8bLgk.css","assets/WithdrawHistory-DHP8vzgx.js","assets/WithdrawHistory-B8rhhWLT.css","assets/BankAccounts-HQraTq1E.js","assets/BankAccounts-DnqUcxsd.css","assets/Security-BXZHzdzl.js","assets/Security-DSBVPCxI.css","assets/Notifications-BElRV5uM.js","assets/Notifications-BOw2FXgH.css","assets/WindowManage-Bw5ACUfB.js","assets/WindowManage-O-DME7xe.css","assets/BusinessTime-fqG4lNet.js","assets/BusinessTime-CtExLDqR.css","assets/PrinterSettings-CeA5_3On.js","assets/PrinterSettings-WK2F2Vuw.css","assets/Help-BTPVXppR.js","assets/Help-CtLRRLYw.css","assets/About-QTWIBIKw.js","assets/About-CoUHvho1.css","assets/OrderHistory-DVS2X2NF.js","assets/OrderHistory-C7Jsyi8t.css","assets/TrafficMonitor-BdXzQSOF.js","assets/TrafficMonitor-uOVwSQc3.css","assets/Reviews-JGljM4sH.js","assets/Reviews-CGa4y1sT.css","assets/ReviewReply-BMpbCkl2.js","assets/ReviewReply-DsBjZddp.css"])))=>i.map(i=>d[i]);
import{o as L,a as _,c as f,w as h,b as v,K as R,r as w,d as y,T as P,n as k,e as V,f as N,g as C,E,h as U,i as B,j as H,k as M,l as F,z as q}from"./vendor-CrV3p34f.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(o){if(o.ep)return;o.ep=!0;const i=r(o);fetch(o.href,i)}})();const x={__name:"App",setup(e){const t=()=>window.cordova||window.Capacitor;L(async()=>{t()&&(window.StatusBar&&(StatusBar.styleDefault(),StatusBar.backgroundColorByHexString("#ffffff")),window.CapApp&&CapApp.addListener("backButton",({canGoBack:i})=>{i?window.history.back():CapApp.exitApp()}),window.SplashScreen&&await SplashScreen.hide())});const r=i=>{i._scrollPosition=window.scrollY},n=i=>{i._scrollPosition&&k(()=>{window.scrollTo(0,i._scrollPosition)})},o=()=>{window.scrollTo(0,0)};return(i,s)=>{const c=V("router-view");return _(),f(c,null,{default:h(({Component:l})=>[v(P,{name:"fade",mode:"out-in",onBeforeLeave:r,onEnter:n,onAfterEnter:o},{default:h(()=>[(_(),f(R,null,[i.$route.meta.keepAlive?(_(),f(w(l),{key:0})):y("",!0)],1024))]),_:2},1024),v(P,{name:"fade",mode:"out-in"},{default:h(()=>[i.$route.meta.keepAlive?y("",!0):(_(),f(w(l),{key:0}))]),_:2},1024)]),_:1})}}},$="modulepreload",z=function(e){return"/Smart-canteen-mobile/"+e},T={},a=function(t,r,n){let o=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),c=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));o=Promise.allSettled(r.map(l=>{if(l=z(l),l in T)return;T[l]=!0;const d=l.endsWith(".css"),g=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${g}`))return;const u=document.createElement("link");if(u.rel=d?"stylesheet":$,d||(u.as="script"),u.crossOrigin="",u.href=l,c&&u.setAttribute("nonce",c),document.head.appendChild(u),d)return new Promise((b,D)=>{u.addEventListener("load",b),u.addEventListener("error",()=>D(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(s){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=s,window.dispatchEvent(c),!c.defaultPrevented)throw s}return o.then(s=>{for(const c of s||[])c.status==="rejected"&&i(c.reason);return t().catch(i)})},K=[{path:"/",redirect:"/login"},{path:"/login",name:"Login",component:()=>a(()=>import("./Login-C_aQ_ZRh.js"),__vite__mapDeps([0,1,2,3,4])),meta:{requiresAuth:!1}},{path:"/m/admin",component:()=>a(()=>import("./Layout-C_DY7tAy.js"),__vite__mapDeps([5,1,2,3,6])),meta:{requiresAuth:!0},children:[{path:"",redirect:"orders"},{path:"orders",name:"MobileAdminOrders",component:()=>a(()=>import("./Orders-ym5KTIzT.js"),__vite__mapDeps([7,1,2,3,8])),meta:{keepAlive:!0}},{path:"menu",name:"MobileAdminMenu",component:()=>a(()=>import("./Menu-B6dnXY5g.js"),__vite__mapDeps([9,1,2,3,10])),meta:{keepAlive:!0}},{path:"stats",name:"MobileAdminStats",component:()=>a(()=>import("./Stats-B5kjNwAh.js"),__vite__mapDeps([11,1,2,3,12])),meta:{keepAlive:!0}},{path:"profile",name:"MobileAdminProfile",component:()=>a(()=>import("./Profile-DPK01GhW.js"),__vite__mapDeps([13,1,2,3,14])),meta:{keepAlive:!0}},{path:"profile/withdraw",name:"AdminWithdraw",component:()=>a(()=>import("./Withdraw-qFR6BGCY.js"),__vite__mapDeps([15,1,2,3,16])),meta:{title:"提现管理"}},{path:"profile/withdraw/history",name:"AdminWithdrawHistory",component:()=>a(()=>import("./WithdrawHistory-DHP8vzgx.js"),__vite__mapDeps([17,1,2,3,18])),meta:{title:"提现记录"}},{path:"profile/bank-accounts",name:"AdminBankAccounts",component:()=>a(()=>import("./BankAccounts-HQraTq1E.js"),__vite__mapDeps([19,1,2,3,20])),meta:{title:"收款账户"}},{path:"profile/security",name:"AdminSecurity",component:()=>a(()=>import("./Security-BXZHzdzl.js"),__vite__mapDeps([21,1,2,3,22])),meta:{title:"安全设置"}},{path:"profile/notifications",name:"AdminNotifications",component:()=>a(()=>import("./Notifications-BElRV5uM.js"),__vite__mapDeps([23,1,2,3,24])),meta:{title:"消息通知"}},{path:"profile/window",name:"AdminWindow",component:()=>a(()=>import("./WindowManage-Bw5ACUfB.js"),__vite__mapDeps([25,1,2,3,26])),meta:{title:"窗口管理"}},{path:"profile/business-time",name:"AdminBusinessTime",component:()=>a(()=>import("./BusinessTime-fqG4lNet.js"),__vite__mapDeps([27,1,2,3,28])),meta:{title:"营业时间"}},{path:"profile/printer",name:"AdminPrinter",component:()=>a(()=>import("./PrinterSettings-CeA5_3On.js"),__vite__mapDeps([29,1,2,3,30])),meta:{title:"打印机设置"}},{path:"profile/help",name:"AdminHelp",component:()=>a(()=>import("./Help-BTPVXppR.js"),__vite__mapDeps([31,1,2,3,32])),meta:{title:"帮助中心"}},{path:"profile/about",name:"AdminAbout",component:()=>a(()=>import("./About-QTWIBIKw.js"),__vite__mapDeps([33,1,2,3,34])),meta:{title:"关于我们"}},{path:"order-history",component:()=>a(()=>import("./OrderHistory-DVS2X2NF.js"),__vite__mapDeps([35,1,2,3,36])),meta:{title:"历史订单"}},{path:"traffic",name:"MobileTrafficMonitor",component:()=>a(()=>import("./TrafficMonitor-BdXzQSOF.js"),__vite__mapDeps([37,1,2,3,38])),meta:{keepAlive:!0}},{path:"reviews",name:"MobileAdminReviews",component:()=>a(()=>import("./Reviews-JGljM4sH.js"),__vite__mapDeps([39,1,2,3,40])),meta:{keepAlive:!0,title:"评价管理"}},{path:"reviews/reply/:id",name:"review-reply",component:()=>a(()=>import("./ReviewReply-BMpbCkl2.js"),__vite__mapDeps([41,1,2,3,42])),meta:{title:"回复评价"}}]},{path:"/:pathMatch(.*)*",redirect:"/login"}],A=N({history:C(),base:"/Smart-canteen-mobile/",routes:K});A.beforeEach(async(e,t,r)=>{const n=localStorage.getItem("token");if(e.meta.requiresAuth&&!n){r({path:"/login",query:{redirect:e.fullPath}});return}if(e.path==="/login"&&n){r("/m/admin/orders");return}if(e.path==="/"&&!n){r("/login");return}r()});const m={handle(e,t,r){var n;console.error("Error:",e),console.error("Component:",t),console.error("Info:",r);try{e.name==="NetworkError"?E.error("网络连接失败，请检查网络设置"):((n=e.response)==null?void 0:n.status)===401?(E.error("登录已过期，请重新登录"),A.push("/login")):E.error(e.message||"操作失败，请重试")}catch(o){console.error("Error in error handler:",o)}}},O={userInfo:{name:"张三",studentId:"2021001001",avatar:"",balance:99.5,points:100,favorites:12,feedbacks:0,pointsHistory:[],phone:"13800138000",email:"zhangsan@example.com"}},W={userInfo:e=>e.userInfo,userBalance:e=>e.userInfo.balance},j={SET_USER_INFO(e,t){e.userInfo=t},UPDATE_USER_INFO(e,t){e.userInfo={...e.userInfo,...t}},UPDATE_BALANCE(e,t){e.userInfo.balance=t},UPDATE_POINTS(e,t){e.userInfo.points=t},ADD_POINTS_HISTORY(e,t){e.userInfo.pointsHistory.unshift(t)},UPDATE_FEEDBACKS_COUNT(e,t){e.userInfo.feedbacks=t}},J={async updateUserInfo({commit:e},t){try{return await new Promise(r=>setTimeout(r,500)),e("UPDATE_USER_INFO",t),t}catch(r){throw m.handle(r),r}},async fetchUserInfo({commit:e}){try{const t=localStorage.getItem("userInfo"),r=t?JSON.parse(t):O.userInfo;return e("SET_USER_INFO",r),r}catch(t){throw m.handle(t),t}},async updateBalance({commit:e,state:t},r){try{const n=t.userInfo.balance+r;return e("UPDATE_BALANCE",n),n}catch(n){throw m.handle(n),n}},async exchangePoints({commit:e,state:t},{itemId:r,points:n}){try{if(t.userInfo.points<n)throw new Error("积分不足");const o=t.userInfo.points-n;return e("UPDATE_POINTS",o),e("ADD_POINTS_HISTORY",{id:Date.now(),type:"exchange",points:-n,description:"积分兑换",createTime:new Date().toISOString()}),!0}catch(o){throw m.handle(o),o}},async getPointsHistory({state:e}){try{return e.userInfo.pointsHistory||[{id:1,type:"earn",points:2,description:"完成订单",createTime:"2024-03-20T10:00:00Z"},{id:2,type:"earn",points:3,description:"评价订单",createTime:"2024-03-19T15:30:00Z"}]}catch(t){throw m.handle(t),t}},updateFeedbacksCount({commit:e},t){e("UPDATE_FEEDBACKS_COUNT",t)},async logout({commit:e}){try{return localStorage.removeItem("userInfo"),localStorage.removeItem("token"),e("SET_USER_INFO",{name:"",studentId:"",avatar:"",balance:0,points:0,favorites:0,feedbacks:0,pointsHistory:[],phone:"",email:""}),!0}catch(t){throw m.handle(t),t}}},Y={namespaced:!0,state:O,getters:W,mutations:j,actions:J},I=U({strict:!1,modules:{user:Y},plugins:[e=>{e.subscribeAction({error:(t,r,n)=>{console.error(`Error in action ${t.type}:`,n)}})}]});I.subscribe((e,t)=>{localStorage.setItem("vuex-state",JSON.stringify(t))});const S=localStorage.getItem("vuex-state");S&&I.replaceState(JSON.parse(S));const p=B(x),Z=H();for(const[e,t]of Object.entries(M))p.component(e,t);p.use(F,{locale:q});p.config.errorHandler=(e,t,r)=>{var n;(n=e.message)!=null&&n.includes("ResizeObserver")||m.handle(e,t,r)};window.onerror=(e,t,r,n,o)=>(e.includes("ResizeObserver")||m.handle(o||new Error(e)),!0);p.use(I);p.use(Z);p.use(A);p.mount("#app");export{A as r};
